generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

enum Rol {
  CLIENTE
  PRESTADOR
}

model Usuario {
  id         Int        @id @default(autoincrement())
  nombre     String
  apellido   String
  email      String     @unique
  telefono   String?    // 🟢 Ahora opcional
  calle      String?    // 🟢 Ahora opcional
  numero     String?    // 🟢 Ahora opcional
  localidad  String?    // 🟢 Ahora opcional
  imagen     String?    // 🆕 Nuevo campo para guardar avatar (URL o base64)
  password   String
  rol        Rol
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt

  servicios  Servicio[]
}


model Servicio {
  id          Int             @id @default(autoincrement())
  titulo      String
  categoria   String
  ubicacion   String
  comentario  String
  imagen      String
  email       String?
  descripcion String?
  rating      Float?          @default(4.0)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  usuarioId   Int
  usuario     Usuario         @relation(fields: [usuarioId], references: [id])

  items       ServicioItem[]
  turnos      Turno[]
  resenas     Resena[]

  @@index([categoria])
  @@index([ubicacion])
}


model ServicioItem {
  id         Int       @id @default(autoincrement())
  nombre     String
  servicio   Servicio  @relation(fields: [servicioId], references: [id], onDelete: Cascade)
  servicioId Int
}

model Turno {
  id         Int       @id @default(autoincrement())
  servicioId Int?
  servicio   Servicio? @relation(fields: [servicioId], references: [id])
  nombre     String
  email      String
  fecha      DateTime?
  detalle    String?
  estado     String    @default("pendiente")
  createdAt  DateTime  @default(now())
}

model Resena {
  id         Int       @id @default(autoincrement())
  servicioId Int
  servicio   Servicio  @relation(fields: [servicioId], references: [id])
  nombre     String
  email      String
  comentario String
  puntaje    Int       // de 1 a 5
  createdAt  DateTime  @default(now())
}
