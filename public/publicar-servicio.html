<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#d97706" />
  <title>Serv-list ¬∑ Publicar servicio</title>

  <!-- üß© FIX: aplicar modo oscuro antes del CSS -->
  <script>
    (function() {
      try {
        const theme = localStorage.getItem("theme");
        if (theme === "dark") {
          // Aplica el modo oscuro ANTES de que cargue el CSS
          document.documentElement.classList.add("dark");
        }
      } catch (e) {}
    })();
  </script>

  <!-- üßæ Estilos principales -->
  <link rel="stylesheet" href="styles.css" />

  <!-- üß† Fuente base (Montserrat) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
</head>


<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="index.html">Serv-list</a>
      <nav class="nav"><!-- generado din√°micamente por nav.js --></nav>
    </div>
  </header>

  <main class="container">
    <h1 class="titulo-centrado">Publicar un nuevo servicio</h1>
    <p class="muted centrado">Complet√° los datos para ofrecer tu servicio en Serv-list.</p>

    <form class="form" id="form-publicar">
      <label>
        <span>Nombre completo</span>
        <input type="text" name="titulo" placeholder="Ej. Juan P√©rez" required />
      </label>

      <label>
        <span>Categor√≠a</span>
        <select name="categoria" required>
          <option value="">Seleccionar...</option>
          <option>Electricista</option>
          <option>Plomer√≠a</option>
          <option>Carpinter√≠a</option>
          <option>Limpieza</option>
        </select>
      </label>

      <label>
        <span>Ubicaci√≥n</span>
        <select name="ubicacion" required>
          <option value="">Seleccionar...</option>
          <option>C√≥rdoba</option>
          <option>Buenos Aires</option>
          <option>Rosario</option>
          <option>Mendoza</option>
        </select>
      </label>

      <label class="grow">
        <span>Email de contacto</span>
        <input type="email" name="email" placeholder="ejemplo@correo.com" required />
      </label>

      <label class="grow">
        <span>Comentario breve</span>
        <input type="text" name="comentario" placeholder="Ej. Instalaciones r√°pidas y seguras" required />
      </label>

      <label class="grow">
        <span>Descripci√≥n detallada</span>
        <textarea name="descripcion" rows="4" placeholder="Cont√° tu experiencia, certificaciones, y c√≥mo trabaj√°s..." required></textarea>
      </label>

      <label class="grow">
        <span>Servicios que ofrec√©s (separados por coma)</span>
        <input type="text" name="items" placeholder="Ej. Instalaciones el√©ctricas, Reparaci√≥n de enchufes, Mantenimiento" />
      </label>

      <label class="grow">
        <span>URL de imagen (opcional)</span>
        <input type="url" name="imagen" placeholder="https://... o /assets/archivo.jpg" />
      </label>

      <button class="btn" type="submit">Publicar</button>
    </form>

    <p id="publicado-ok" class="muted centrado" style="display:none;">‚úÖ ¬°Servicio publicado correctamente!</p>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p class="muted">¬© 2025 Serv-list ¬∑ Proyecto de Ingenier√≠a y Calidad de Software</p>
    </div>
  </footer>

  <!-- =========================
       üìú Scripts globales
  ========================== -->
  <script src="scripts/nav.js"></script>
  <script src="scripts/theme.js"></script>
  <script src="app.js"></script>

  <!-- =========================
       üîí Validaci√≥n de sesi√≥n
  ========================== -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const token = localStorage.getItem("token");
      if (!token) {
        alert("Ten√©s que iniciar sesi√≥n para publicar un servicio.");
        window.location.href = "iniciar-sesion.html";
      }
    });
  </script>
  <!-- üîí Protecci√≥n seg√∫n rol -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const token = localStorage.getItem("token");
    const rol = localStorage.getItem("rol");

    if (!token) {
      alert("Ten√©s que iniciar sesi√≥n para publicar un servicio.");
      window.location.href = "iniciar-sesion.html";
      return;
    }

    if (rol !== "PRESTADOR") {
      alert("Solo los prestadores pueden publicar servicios.");
      window.location.href = "perfil.html";
      return;
    }
  });
</script>
</body>
</html>